# Практическая работа 8. Использование Task и async/await

### Цель работы

Научиться создавать асинхронные задачи в C# с помощью класса `Task` и ключевых слов `async`/`await`. Освоить выполнение параллельных операций без блокировки основного потока.

---

## **Теоретическая часть**

1. **Task**

   * `Task` представляет асинхронную операцию.
   * Создаётся с помощью `Task.Run()` или конструктора `Task`.
   * Позволяет выполнять код параллельно и получать результат.

   ```csharp
   Task t = Task.Run(() => Console.WriteLine("Hello from Task"));
   t.Wait();
   ```

2. **async/await**

   * `async` помечает метод как асинхронный.
   * `await` позволяет "ожидать" завершения задачи без блокировки потока.
   * Пример:

   ```csharp
   async Task<int> CalculateAsync()
   {
       await Task.Delay(1000); // имитация длительной работы
       return 42;
   }
   ```

3. **Преимущества асинхронного программирования**

   * Основной поток UI не блокируется (актуально для приложений с интерфейсом)
   * Возможность параллельного выполнения нескольких задач
   * Упрощение работы с сетевыми запросами, файлами и базой данных

4. **Методы Task**

   * `Task.Wait()` — ожидает завершения задачи
   * `Task.Result` — получает результат задачи (блокирует до завершения)
   * `Task.WhenAll()` — ожидание завершения нескольких задач
   * `Task.WhenAny()` — ожидание первой завершившейся задачи

---

## **Ход работы**

1. Создать проект `AsyncDemo` (консольное приложение .NET).
2. Реализовать метод, который выполняет длительную операцию (например, имитация загрузки данных с `Task.Delay`).
3. Создать несколько задач (`Task`) и запустить их параллельно.
4. Использовать `async`/`await` для асинхронного ожидания результатов.
5. Вывести результаты всех задач на экран.
6. Сделать скриншоты работы программы и поместить их в папку `images`.
7. Создать `readme.md` с описанием задания и примером кода.

---

## **Пример практического задания**

**Задание:**

1. Создать метод `DownloadDataAsync(string url)`, который имитирует загрузку данных (использовать `Task.Delay`).
2. Создать несколько URL и запускать их загрузку параллельно с помощью `Task`.
3. Использовать `async/await` для ожидания всех задач.
4. Вывести сообщение о завершении загрузки каждого URL.
5. В `Main` продемонстрировать асинхронное выполнение задач.

**Пример кода:**

```csharp
using System;
using System.Threading.Tasks;

class Program
{
    static async Task<string> DownloadDataAsync(string url)
    {
        Console.WriteLine($"Начало загрузки: {url}");
        await Task.Delay(1000); // имитация загрузки
        Console.WriteLine($"Загрузка завершена: {url}");
        return $"Данные с {url}";
    }

    static async Task Main()
    {
        string[] urls = { "site1.com", "site2.com", "site3.com" };

        Task<string>[] tasks = new Task<string>[urls.Length];

        for (int i = 0; i < urls.Length; i++)
        {
            tasks[i] = DownloadDataAsync(urls[i]);
        }

        string[] results = await Task.WhenAll(tasks);

        Console.WriteLine("Все загрузки завершены:");
        foreach (var result in results)
        {
            Console.WriteLine(result);
        }
    }
}
```

---

## **Критерии оценки**

| Оценка | Критерий                                                                                                 |
| ------ | -------------------------------------------------------------------------------------------------------- |
| 2      | Программа частично работает, задачи выполняются последовательно или ошибки при async/await               |
| 3      | Все задачи выполняются асинхронно, результат выводится корректно                                         |
| 4      | Использовано несколько задач с Task, корректная обработка результатов, аккуратный код                    |
| 5      | Отличная реализация: параллельные задачи, async/await, корректный вывод, скриншоты и readme присутствуют |

---

## **Контрольные вопросы**

1. Чем Task отличается от Thread?
2. Для чего используются ключевые слова `async` и `await`?
3. Как ожидать завершения нескольких задач параллельно?
4. Что произойдёт, если использовать `Task.Result` без await?
5. Какие преимущества асинхронного программирования в консольных и UI приложениях?

---

## **Структура репозитория**

```
AsyncDemo/
│
├── AsyncDemo.sln
├── AsyncDemo/
│   ├── Program.cs
│
├── images/
│   ├── screenshot1.png
│   └── screenshot2.png
│
└── readme.md
```

### **Пример readme.md**

````markdown
# Практическая работа №8

**Тема:** Использование Task и async/await  

## Задание
1. Создать метод DownloadDataAsync(string url), который имитирует загрузку данных с помощью Task.Delay.
2. Создать несколько URL и запускать их загрузку параллельно с помощью Task.
3. Использовать async/await для ожидания всех задач.
4. Вывести сообщение о завершении загрузки каждого URL.
5. В Main продемонстрировать асинхронное выполнение задач.

## Пример кода
```csharp
using System;
using System.Threading.Tasks;

class Program
{
    static async Task<string> DownloadDataAsync(string url)
    {
        Console.WriteLine($"Начало загрузки: {url}");
        await Task.Delay(1000); // имитация загрузки
        Console.WriteLine($"Загрузка завершена: {url}");
        return $"Данные с {url}";
    }

    static async Task Main()
    {
        string[] urls = { "site1.com", "site2.com", "site3.com" };

        Task<string>[] tasks = new Task<string>[urls.Length];

        for (int i = 0; i < urls.Length; i++)
        {
            tasks[i] = DownloadDataAsync(urls[i]);
        }

        string[] results = await Task.WhenAll(tasks);

        Console.WriteLine("Все загрузки завершены:");
        foreach (var result in results)
        {
            Console.WriteLine(result);
        }
    }
}
```
```
