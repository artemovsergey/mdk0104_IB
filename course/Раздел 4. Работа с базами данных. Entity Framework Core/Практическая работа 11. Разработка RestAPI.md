# Практическая работа 11. Разработка REST API

### Цель работы

Научиться создавать RESTful API на C# с использованием ASP.NET Core. Освоить обработку HTTP-запросов, маршрутизацию, работу с контроллерами и базой данных через Entity Framework Core.

---

## **Теоретическая часть**

1. **Что такое REST API**

   * REST (Representational State Transfer) — архитектурный стиль для веб-сервисов.
   * REST API использует HTTP методы:

     * `GET` — получить данные
     * `POST` — создать запись
     * `PUT`/`PATCH` — обновить запись
     * `DELETE` — удалить запись
   * Обмен данными чаще всего в формате JSON.

2. **ASP.NET Core Web API**

   * Позволяет создавать REST API с минимальными усилиями.
   * Основные компоненты:

     * **Controller** — контроллеры для обработки запросов
     * **Routing** — маршрутизация URL к методам
     * **Model** — модели данных
     * **DbContext** — доступ к базе данных через EF Core

3. **Маршрутизация**

   * `[Route("api/[controller]")]` — маршрут по имени контроллера
   * `[HttpGet]`, `[HttpPost]`, `[HttpPut]`, `[HttpDelete]` — обработка HTTP методов

4. **Работа с Entity Framework Core**

   * Используется для CRUD операций в базе данных.
   * Пример: `context.Students.ToList()`, `context.Students.Add(student)`, `context.SaveChanges()`

---

## **Ход работы**

1. Создать проект `RestApiDemo` (ASP.NET Core Web API).
2. Создать модели:

   * `Student` (Id, Name, Age)
3. Создать DbContext `SchoolContext` и настроить подключение к SQLite.
4. Создать контроллер `StudentsController` с методами:

   * `GET /api/students` — получить всех студентов
   * `GET /api/students/{id}` — получить студента по Id
   * `POST /api/students` — создать нового студента
   * `PUT /api/students/{id}` — обновить студента
   * `DELETE /api/students/{id}` — удалить студента
5. Запустить проект и протестировать API через Postman или браузер.
6. Сделать скриншоты работы API и поместить их в папку `images`.
7. Создать `readme.md` с описанием задания и примером кода.

---

## **Пример практического задания**

**Задание:**

1. Создать модель `Student` (Id, Name, Age).
2. Создать DbContext `SchoolContext`.
3. Создать контроллер `StudentsController` с CRUD методами.
4. Настроить маршрутизацию для REST API.
5. Проверить работу API через Postman:

   * Создать нового студента
   * Получить список студентов
   * Обновить данные студента
   * Удалить студента

**Пример кода модели и контекста:**

```csharp
using Microsoft.EntityFrameworkCore;

public class Student
{
    public int Id { get; set; }
    public string Name { get; set; }
    public int Age { get; set; }
}

public class SchoolContext : DbContext
{
    public SchoolContext(DbContextOptions<SchoolContext> options) : base(options) { }

    public DbSet<Student> Students { get; set; }
}
```

**Пример контроллера:**

```csharp
using Microsoft.AspNetCore.Mvc;
using System.Collections.Generic;
using System.Linq;

[Route("api/[controller]")]
[ApiController]
public class StudentsController : ControllerBase
{
    private readonly SchoolContext _context;

    public StudentsController(SchoolContext context)
    {
        _context = context;
    }

    [HttpGet]
    public ActionResult<IEnumerable<Student>> GetStudents()
    {
        return _context.Students.ToList();
    }

    [HttpGet("{id}")]
    public ActionResult<Student> GetStudent(int id)
    {
        var student = _context.Students.Find(id);
        if (student == null) return NotFound();
        return student;
    }

    [HttpPost]
    public ActionResult<Student> CreateStudent(Student student)
    {
        _context.Students.Add(student);
        _context.SaveChanges();
        return CreatedAtAction(nameof(GetStudent), new { id = student.Id }, student);
    }

    [HttpPut("{id}")]
    public IActionResult UpdateStudent(int id, Student student)
    {
        var existing = _context.Students.Find(id);
        if (existing == null) return NotFound();
        existing.Name = student.Name;
        existing.Age = student.Age;
        _context.SaveChanges();
        return NoContent();
    }

    [HttpDelete("{id}")]
    public IActionResult DeleteStudent(int id)
    {
        var student = _context.Students.Find(id);
        if (student == null) return NotFound();
        _context.Students.Remove(student);
        _context.SaveChanges();
        return NoContent();
    }
}
```

---

## **Критерии оценки**

| Оценка | Критерий                                                                                                                         |
| ------ | -------------------------------------------------------------------------------------------------------------------------------- |
| 2      | Частично реализованы CRUD методы, API не работает корректно                                                                      |
| 3      | Реализованы все методы CRUD, базовая проверка данных                                                                             |
| 4      | Полностью рабочее API с маршрутизацией и корректным доступом к БД                                                                |
| 5      | Отличная реализация API, корректные маршруты, использование EF Core, тестирование через Postman, скриншоты и readme присутствуют |

---

## **Контрольные вопросы**

1. Что такое REST API и какие HTTP методы чаще всего используются?
2. Для чего нужен контроллер в ASP.NET Core Web API?
3. Как настроить маршрутизацию `[Route("api/[controller]")]`?
4. Как выполнять CRUD операции через EF Core в API?
5. Чем отличается метод `CreatedAtAction` от `Ok()`?

---

## **Структура репозитория**

```
RestApiDemo/
│
├── RestApiDemo.sln
├── RestApiDemo/
│   ├── Program.cs
│   ├── Models/
│   │   └── Student.cs
│   ├── Data/
│   │   └── SchoolContext.cs
│   └── Controllers/
│       └── StudentsController.cs
│
├── images/
│   ├── screenshot_get.png
│   └── screenshot_post.png
│
└── readme.md
```

### **Пример readme.md**

````markdown
# Практическая работа №11

**Тема:** Разработка REST API  

## Задание
1. Создать модель Student (Id, Name, Age)
2. Создать DbContext SchoolContext
3. Создать контроллер StudentsController с CRUD методами
4. Настроить маршрутизацию REST API
5. Протестировать API через Postman:
   - GET /api/students
   - GET /api/students/{id}
   - POST /api/students
   - PUT /api/students/{id}
   - DELETE /api/students/{id}

## Пример кода
```csharp
// Пример контроллера приведен выше
```

```