# Практическая работа 12. Сортировка, фильтрация, поиск, пагинация

### Цель работы

Научиться реализовывать в C# обработку коллекций и данных с использованием **сортировки**, **фильтрации**, **поиска** и **пагинации** с применением LINQ и Entity Framework Core.

---

## **Теоретическая часть**

1. **Сортировка**

   * Используется для упорядочивания данных по определённому признаку.
   * LINQ методы:

     ```csharp
     var sorted = students.OrderBy(s => s.Name).ToList();
     var sortedDesc = students.OrderByDescending(s => s.Age).ToList();
     ```

2. **Фильтрация**

   * Позволяет выбрать элементы, удовлетворяющие условию.
   * LINQ метод `Where`:

     ```csharp
     var adults = students.Where(s => s.Age >= 18).ToList();
     ```

3. **Поиск**

   * Используется для поиска конкретных элементов.
   * Методы LINQ:

     ```csharp
     var student = students.FirstOrDefault(s => s.Name == "Alice");
     var exists = students.Any(s => s.Id == 5);
     ```

4. **Пагинация**

   * Разделение данных на страницы для удобного отображения.
   * Методы LINQ:

     ```csharp
     int pageNumber = 2;
     int pageSize = 3;
     var page = students.Skip((pageNumber - 1) * pageSize)
                        .Take(pageSize)
                        .ToList();
     ```

5. **Применение в EF Core**

   * Все перечисленные операции можно выполнять как на in-memory коллекциях, так и на базе данных через `DbSet`.
   * LINQ-запросы транслируются в SQL.

---

## **Ход работы**

1. Создать проект `DataQueryDemo` (консольное приложение .NET Core или ASP.NET Core Web API).
2. Создать модель `Student` (Id, Name, Age).
3. Добавить несколько записей в базу данных.
4. Реализовать:

   * Сортировку по имени и возрасту
   * Фильтрацию по возрасту (например, старше 18)
   * Поиск студента по имени или Id
   * Пагинацию (например, по 3 студента на странице)
5. Вывести результаты всех операций на экран или через API.
6. Сделать скриншоты работы программы и поместить их в папку `images`.
7. Создать `readme.md` с описанием задания и примером кода.

---

## **Пример практического задания**

**Задание:**

1. Создать проект `DataQueryDemo` с моделью `Student` (Id, Name, Age) и контекстом `SchoolContext`.
2. Заполнить базу 10–15 студентами.
3. Реализовать:

   * Сортировку по имени и возрасту (по возрастанию и убыванию)
   * Фильтрацию студентов старше 18 лет
   * Поиск студента по имени
   * Пагинацию по 3 студента на страницу
4. Вывести результаты каждой операции на экран.

---

## **Пример кода**

```csharp
using System;
using System.Linq;
using Microsoft.EntityFrameworkCore;
using System.Collections.Generic;

public class Student
{
    public int Id { get; set; }
    public string Name { get; set; }
    public int Age { get; set; }
}

public class SchoolContext : DbContext
{
    public DbSet<Student> Students { get; set; }

    protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)
    {
        optionsBuilder.UseSqlite("Data Source=school.db");
    }
}

class Program
{
    static void Main()
    {
        using var context = new SchoolContext();
        context.Database.EnsureCreated();

        if (!context.Students.Any())
        {
            var students = new List<Student>
            {
                new Student { Name="Alice", Age=20 },
                new Student { Name="Bob", Age=17 },
                new Student { Name="Charlie", Age=22 },
                new Student { Name="Diana", Age=19 },
                new Student { Name="Eve", Age=21 },
                new Student { Name="Frank", Age=18 },
                new Student { Name="Grace", Age=23 },
                new Student { Name="Hank", Age=16 },
                new Student { Name="Ivy", Age=20 },
                new Student { Name="Jack", Age=24 }
            };
            context.Students.AddRange(students);
            context.SaveChanges();
        }

        // Сортировка по имени
        var sortedByName = context.Students.OrderBy(s => s.Name).ToList();
        Console.WriteLine("Сортировка по имени:");
        sortedByName.ForEach(s => Console.WriteLine($"{s.Name} ({s.Age})"));

        // Фильтрация старше 18
        var adults = context.Students.Where(s => s.Age > 18).ToList();
        Console.WriteLine("\nСтуденты старше 18:");
        adults.ForEach(s => Console.WriteLine($"{s.Name} ({s.Age})"));

        // Поиск по имени
        var studentNamedBob = context.Students.FirstOrDefault(s => s.Name == "Bob");
        Console.WriteLine($"\nПоиск студента по имени 'Bob': {studentNamedBob?.Name} ({studentNamedBob?.Age})");

        // Пагинация (по 3 на страницу)
        int pageSize = 3;
        for (int page = 1; page <= 4; page++)
        {
            var studentsPage = context.Students
                                      .OrderBy(s => s.Id)
                                      .Skip((page - 1) * pageSize)
                                      .Take(pageSize)
                                      .ToList();
            Console.WriteLine($"\nСтраница {page}:");
            studentsPage.ForEach(s => Console.WriteLine($"{s.Id}: {s.Name} ({s.Age})"));
        }
    }
}
```

---

## **Критерии оценки**

| Оценка | Критерий                                                                           |
| ------ | ---------------------------------------------------------------------------------- |
| 2      | Частичная реализация, одна операция (сортировка/фильтрация/поиск/пагинация)        |
| 3      | Реализованы 2–3 операции, данные корректно отображаются                            |
| 4      | Реализованы все операции, вывод корректен, используется база данных через EF Core  |
| 5      | Отличная реализация всех операций, аккуратный код, скриншоты и readme присутствуют |

---

## **Контрольные вопросы**

1. Какие методы LINQ используются для сортировки и фильтрации?
2. Как реализовать поиск записи по определённому условию?
3. Что такое пагинация и зачем она нужна?
4. Чем `Skip()` и `Take()` отличаются друг от друга?
5. Как использовать LINQ для запросов к базе данных через EF Core?

---

## **Структура репозитория**

```
DataQueryDemo/
│
├── DataQueryDemo.sln
├── DataQueryDemo/
│   ├── Program.cs
│   ├── Models/
│   │   └── Student.cs
│   └── Data/
│       └── SchoolContext.cs
│
├── images/
│   ├── screenshot_sort.png
│   ├── screenshot_filter.png
│   ├── screenshot_search.png
│   └── screenshot_pagination.png
│
└── readme.md
```

### **Пример readme.md**

````markdown
# Практическая работа №12

**Тема:** Сортировка, фильтрация, поиск, пагинация  

## Задание
1. Создать модель Student (Id, Name, Age) и контекст SchoolContext
2. Заполнить базу 10–15 студентами
3. Реализовать:
   - Сортировку по имени и возрасту
   - Фильтрацию студентов старше 18 лет
   - Поиск студента по имени
   - Пагинацию по 3 студента на страницу
4. Вывести результаты каждой операции на экран

## Пример кода
```csharp
// Пример кода приведен выше
```

```